# Lucid Admin Interface - Admin Interface Configuration
# Optional YAML configuration for admin interface service
# File: admin/config/admin-interface-config.yaml
# Purpose: Define RBAC policies, system monitoring, and administrative controls

# Global Admin Interface Configuration
global:
  service_name: "lucid-admin-interface"
  service_version: "1.0.0"
  debug: false
  log_level: "INFO"
  host: "0.0.0.0"
  port: 8083

# Database Configuration
database:
  mongodb:
    url: "mongodb://lucid-mongodb:27017/lucid"
    database: "lucid"
    connection_timeout: 30
    max_pool_size: 100
    min_pool_size: 10
  
  redis:
    url: "redis://lucid-redis:6379/0"
    cache_ttl_seconds: 300
  
  elasticsearch:
    url: "http://lucid-elasticsearch:9200"
    index_prefix: "lucid_admin"

# Security Configuration
security:
  # JWT Configuration
  jwt:
    secret_key: null  # Set via environment variable
    algorithm: "HS256"
    access_token_expire_minutes: 15
    refresh_token_expire_days: 7
  
  # Password Policy
  password:
    min_length: 12
    require_special_chars: true
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
  
  # Session Configuration
  session:
    timeout_hours: 8
    max_login_attempts: 5
    lockout_duration_minutes: 30
  
  # TOTP Configuration
  totp:
    issuer: "Lucid Admin"
    window: 1

# RBAC Configuration
rbac:
  # Role Hierarchy
  roles:
    super_admin:
      name: "super_admin"
      description: "Super administrator with full system access"
      permissions:
        - "*"  # All permissions
      inherits: []
    
    admin:
      name: "admin"
      description: "Administrator with system management access"
      permissions:
        - "system:read"
        - "system:write"
        - "users:read"
        - "users:write"
        - "sessions:read"
        - "sessions:write"
        - "nodes:read"
        - "nodes:write"
        - "blockchain:read"
        - "blockchain:write"
      inherits: ["operator", "read_only"]
    
    operator:
      name: "operator"
      description: "Node operator with operational access"
      permissions:
        - "system:read"
        - "users:read"
        - "sessions:read"
        - "sessions:write"
        - "nodes:read"
        - "nodes:write"
        - "blockchain:read"
      inherits: ["read_only"]
    
    read_only:
      name: "read_only"
      description: "Read-only access to system information"
      permissions:
        - "system:read"
        - "users:read"
        - "sessions:read"
        - "nodes:read"
        - "blockchain:read"
      inherits: []
  
  # Permission Cache
  permission_cache:
    enabled: true
    ttl_seconds: 300

# External Service URLs
external_services:
  api_gateway_url: "http://api-gateway:8080"
  blockchain_url: "http://blockchain-engine:8084"
  session_management_url: "http://session-api:8087"
  node_management_url: "http://node-management:8095"
  auth_service_url: "http://lucid-auth-service:8089"

# CORS Configuration
cors:
  enabled: true
  allow_origins:
    - "https://admin.lucid.local"
    - "http://localhost:3000"
    - "http://localhost:8083"
  allow_credentials: true
  allow_methods: ["*"]
  allow_headers: ["*"]

# Rate Limiting
rate_limiting:
  enabled: true
  requests_per_minute: 1000
  window_seconds: 60
  burst_size: 100
  per_endpoint_limits:
    "/admin/users":
      requests_per_minute: 200
      burst_size: 20
    "/admin/sessions":
      requests_per_minute: 200
      burst_size: 20
    "/admin/emergency":
      requests_per_minute: 10
      burst_size: 3

# File Upload Configuration
file_upload:
  max_upload_size_mb: 100
  allowed_file_types:
    - "application/json"
    - "text/csv"
    - "application/pdf"
    - "text/plain"

# Monitoring Configuration
monitoring:
  enabled: true
  metrics:
    enabled: true
    endpoint: "/admin/metrics"
    port: 9090
  
  health_check:
    enabled: true
    endpoint: "/admin/health"
    interval_seconds: 30
    timeout_seconds: 10
  
  system_metrics:
    enabled: true
    collection_interval_seconds: 60
  
  log_retention:
    application_logs_days: 30
    audit_logs_days: 90

# Emergency Controls Configuration
emergency:
  # Emergency Lockdown
  lockdown:
    enabled: true
    notification_emails: []
    auto_notify: false
  
  # Emergency Shutdown
  shutdown:
    enabled: true
    notification_emails: []
    auto_notify: false
  
  # Session Termination
  session_termination:
    enabled: true
    require_confirmation: true
    notification_emails: []
  
  # Node Maintenance
  node_maintenance:
    enabled: true
    require_confirmation: true
    notification_emails: []
  
  # Blockchain Pause
  blockchain_pause:
    enabled: true
    require_confirmation: true
    notification_emails: []

# Audit Logging Configuration
audit:
  enabled: true
  log_connections: true
  log_disconnections: true
  log_errors: true
  log_admin_actions: true
  log_user_actions: true
  log_system_events: true
  retention_days: 90
  include_request_body: false
  include_response_body: false

# Dashboard Configuration
dashboard:
  enabled: true
  refresh_interval_seconds: 30
  metrics:
    - "system_health"
    - "active_sessions"
    - "active_users"
    - "node_count"
    - "blockchain_status"
    - "system_resources"

# Error Handling
error_handling:
  retry:
    enabled: true
    max_retries: 3
    retry_delay_seconds: 1
    exponential_backoff: true
  
  error_responses:
    include_stack_trace: false
    include_details: true
    log_errors: true

