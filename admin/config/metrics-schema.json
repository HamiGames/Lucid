{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Admin Interface Metrics Schema",
  "description": "Schema definition for all metrics exported by the Admin Interface service",
  "version": "1.0.0",
  "metrics": {
    "admin_users_total": {
      "type": "counter",
      "description": "Total number of admin users",
      "help": "Total number of admin users registered in the system",
      "labels": ["role", "status"],
      "label_descriptions": {
        "role": "User role (super_admin, admin, operator, read_only)",
        "status": "User status (active, suspended, disabled)"
      },
      "unit": "users",
      "category": "users"
    },
    "admin_users_active": {
      "type": "gauge",
      "description": "Number of active admin users",
      "help": "Number of currently active admin users",
      "labels": [],
      "unit": "users",
      "category": "users"
    },
    "admin_sessions_total": {
      "type": "counter",
      "description": "Total number of admin sessions",
      "help": "Total number of admin sessions created",
      "labels": ["status"],
      "label_descriptions": {
        "status": "Session status (active, expired, terminated)"
      },
      "unit": "sessions",
      "category": "sessions"
    },
    "admin_sessions_active": {
      "type": "gauge",
      "description": "Number of active admin sessions",
      "help": "Number of currently active admin sessions",
      "labels": [],
      "unit": "sessions",
      "category": "sessions"
    },
    "api_requests_total": {
      "type": "counter",
      "description": "Total number of API requests",
      "help": "Total number of API requests processed",
      "labels": ["method", "endpoint", "status_code", "role"],
      "label_descriptions": {
        "method": "HTTP method (GET, POST, PUT, DELETE, PATCH)",
        "endpoint": "API endpoint path",
        "status_code": "HTTP status code",
        "role": "User role making the request"
      },
      "unit": "requests",
      "category": "api"
    },
    "api_request_duration_seconds": {
      "type": "histogram",
      "description": "API request duration",
      "help": "Time taken to process an API request in seconds",
      "labels": ["method", "endpoint"],
      "label_descriptions": {
        "method": "HTTP method",
        "endpoint": "API endpoint path"
      },
      "unit": "seconds",
      "category": "api"
    },
    "rbac_permission_checks_total": {
      "type": "counter",
      "description": "Total number of RBAC permission checks",
      "help": "Total number of RBAC permission checks performed",
      "labels": ["result"],
      "label_descriptions": {
        "result": "Check result (allowed, denied)"
      },
      "unit": "checks",
      "category": "rbac"
    },
    "audit_events_total": {
      "type": "counter",
      "description": "Total number of audit events",
      "help": "Total number of audit events logged",
      "labels": ["event_type", "severity"],
      "label_descriptions": {
        "event_type": "Event type (login, logout, action, error)",
        "severity": "Event severity (info, warning, error, critical)"
      },
      "unit": "events",
      "category": "audit"
    },
    "emergency_actions_total": {
      "type": "counter",
      "description": "Total number of emergency actions",
      "help": "Total number of emergency actions executed",
      "labels": ["action_type"],
      "label_descriptions": {
        "action_type": "Action type (lockdown, shutdown, session_termination, node_maintenance, blockchain_pause)"
      },
      "unit": "actions",
      "category": "emergency"
    },
    "dashboard_views_total": {
      "type": "counter",
      "description": "Total number of dashboard views",
      "help": "Total number of dashboard page views",
      "labels": ["page"],
      "label_descriptions": {
        "page": "Dashboard page (overview, users, sessions, nodes, blockchain)"
      },
      "unit": "views",
      "category": "dashboard"
    },
    "errors_total": {
      "type": "counter",
      "description": "Total number of errors",
      "help": "Total number of errors encountered",
      "labels": ["error_type", "component"],
      "label_descriptions": {
        "error_type": "Type of error (validation_error, database_error, network_error, auth_error)",
        "component": "Component where error occurred (api, rbac, audit, emergency)"
      },
      "unit": "errors",
      "category": "error"
    },
    "rate_limit_hits_total": {
      "type": "counter",
      "description": "Total number of rate limit hits",
      "help": "Total number of requests blocked by rate limiting",
      "labels": ["endpoint"],
      "label_descriptions": {
        "endpoint": "API endpoint that was rate limited"
      },
      "unit": "hits",
      "category": "rate_limit"
    }
  },
  "categories": {
    "users": {
      "description": "Admin user metrics",
      "metrics": ["admin_users_total", "admin_users_active"]
    },
    "sessions": {
      "description": "Admin session metrics",
      "metrics": ["admin_sessions_total", "admin_sessions_active"]
    },
    "api": {
      "description": "API request metrics",
      "metrics": ["api_requests_total", "api_request_duration_seconds"]
    },
    "rbac": {
      "description": "RBAC permission metrics",
      "metrics": ["rbac_permission_checks_total"]
    },
    "audit": {
      "description": "Audit logging metrics",
      "metrics": ["audit_events_total"]
    },
    "emergency": {
      "description": "Emergency action metrics",
      "metrics": ["emergency_actions_total"]
    },
    "dashboard": {
      "description": "Dashboard usage metrics",
      "metrics": ["dashboard_views_total"]
    },
    "error": {
      "description": "Error metrics",
      "metrics": ["errors_total"]
    },
    "rate_limit": {
      "description": "Rate limiting metrics",
      "metrics": ["rate_limit_hits_total"]
    }
  },
  "default_thresholds": {
    "admin_sessions_active": {
      "warning": 50,
      "critical": 100
    },
    "api_request_duration_seconds": {
      "warning": 1.0,
      "critical": 3.0
    },
    "errors_total": {
      "warning": 10,
      "critical": 50
    }
  },
  "export_endpoint": "/admin/metrics",
  "export_format": "prometheus_text",
  "scrape_interval": "30s"
}

