# Lucid Service Mesh - Service Registry Configuration
# File: service-mesh/config/services.yaml
# Purpose: Pre-defined service configurations for auto-registration
# All values reference environment variables from .env.* files

services:
  # Foundation Services
  lucid-mongodb:
    name: ${MONGODB_SERVICE_NAME:-lucid-mongodb}
    address: ${MONGODB_HOST:-lucid-mongodb}
    port: ${MONGODB_PORT:-27017}
    protocol: tcp
    tags:
      - foundation
      - database
      - mongodb
    health_check:
      type: tcp
      interval: ${MONGODB_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${MONGODB_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: foundation
      priority: critical
      
  lucid-redis:
    name: ${REDIS_SERVICE_NAME:-lucid-redis}
    address: ${REDIS_HOST:-lucid-redis}
    port: ${REDIS_PORT:-6379}
    protocol: tcp
    tags:
      - foundation
      - cache
      - redis
    health_check:
      type: tcp
      interval: ${REDIS_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${REDIS_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: foundation
      priority: critical
      
  tor-proxy:
    name: ${TOR_SERVICE_NAME:-tor-proxy}
    address: ${TOR_HOST:-tor-proxy}
    port: ${TOR_SOCKS_PORT:-9050}
    protocol: tcp
    tags:
      - foundation
      - proxy
      - tor
    health_check:
      type: tcp
      interval: ${TOR_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${TOR_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: foundation
      priority: high

  # Core Services
  api-gateway:
    name: ${API_GATEWAY_SERVICE_NAME:-api-gateway}
    address: ${API_GATEWAY_HOST:-api-gateway}
    port: ${API_GATEWAY_PORT:-8080}
    protocol: http
    tags:
      - core
      - gateway
      - api
    health_check:
      type: http
      path: ${API_GATEWAY_HEALTH_PATH:-/health}
      interval: ${API_GATEWAY_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${API_GATEWAY_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: critical
      
  auth-service:
    name: ${AUTH_SERVICE_NAME:-auth-service}
    address: ${AUTH_HOST:-auth-service}
    port: ${AUTH_PORT:-8084}
    protocol: http
    tags:
      - core
      - auth
      - security
    health_check:
      type: http
      path: ${AUTH_HEALTH_PATH:-/health}
      interval: ${AUTH_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${AUTH_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: critical
      
  session-anchoring:
    name: ${SESSION_ANCHORING_SERVICE_NAME:-session-anchoring}
    address: ${SESSION_ANCHORING_HOST:-session-anchoring}
    port: ${SESSION_ANCHORING_PORT:-8085}
    protocol: http
    tags:
      - core
      - session
      - blockchain
    health_check:
      type: http
      path: ${SESSION_ANCHORING_HEALTH_PATH:-/health}
      interval: ${SESSION_ANCHORING_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${SESSION_ANCHORING_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: high
      
  block-manager:
    name: ${BLOCK_MANAGER_SERVICE_NAME:-block-manager}
    address: ${BLOCK_MANAGER_HOST:-block-manager}
    port: ${BLOCK_MANAGER_PORT:-8086}
    protocol: http
    tags:
      - core
      - blockchain
      - manager
    health_check:
      type: http
      path: ${BLOCK_MANAGER_HEALTH_PATH:-/health}
      interval: ${BLOCK_MANAGER_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${BLOCK_MANAGER_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: high
      
  data-chain:
    name: ${DATA_CHAIN_SERVICE_NAME:-data-chain}
    address: ${DATA_CHAIN_HOST:-data-chain}
    port: ${DATA_CHAIN_PORT:-8087}
    protocol: http
    tags:
      - core
      - blockchain
      - data
    health_check:
      type: http
      path: ${DATA_CHAIN_HEALTH_PATH:-/health}
      interval: ${DATA_CHAIN_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${DATA_CHAIN_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: high
      
  blockchain-engine:
    name: ${BLOCKCHAIN_ENGINE_SERVICE_NAME:-blockchain-engine}
    address: ${BLOCKCHAIN_ENGINE_HOST:-blockchain-engine}
    port: ${BLOCKCHAIN_ENGINE_PORT:-8082}
    protocol: http
    tags:
      - core
      - blockchain
      - engine
    health_check:
      type: http
      path: ${BLOCKCHAIN_ENGINE_HEALTH_PATH:-/health}
      interval: ${BLOCKCHAIN_ENGINE_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${BLOCKCHAIN_ENGINE_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: critical

  # Service Mesh Controller (self-registration)
  service-mesh:
    name: ${SERVICE_MESH_SERVICE_NAME:-service-mesh}
    address: ${SERVICE_MESH_HOST:-service-mesh}
    port: ${SERVICE_MESH_PORT:-8500}
    protocol: http
    tags:
      - core
      - mesh
      - discovery
    health_check:
      type: http
      path: ${SERVICE_MESH_HEALTH_PATH:-/health}
      interval: ${SERVICE_MESH_HEALTH_CHECK_INTERVAL:-30s}
      timeout: ${SERVICE_MESH_HEALTH_CHECK_TIMEOUT:-10s}
    metadata:
      cluster: core
      priority: critical
