# LUCID TRON Staking Service - Error Codes Configuration
# File: payment-systems/tron/config/staking-error-codes.yaml
# Purpose: Staking-specific error codes and recovery strategies

errors:
  # Staking Validation Errors (S1xx)
  staking_validation:
    S100:
      code: "S100"
      message: "Invalid staking address format"
      http_status: 400
      retryable: false
      recovery_action: "validate_address_format"
      severity: "warning"
    
    S101:
      code: "S101"
      message: "Invalid staking amount"
      http_status: 400
      retryable: false
      recovery_action: "validate_staking_amount"
      severity: "warning"
    
    S102:
      code: "S102"
      message: "Staking amount below minimum"
      http_status: 400
      retryable: false
      recovery_action: "check_minimum_amount"
      severity: "warning"
    
    S103:
      code: "S103"
      message: "Staking amount exceeds maximum"
      http_status: 400
      retryable: false
      recovery_action: "check_maximum_amount"
      severity: "warning"
    
    S104:
      code: "S104"
      message: "Invalid staking duration"
      http_status: 400
      retryable: false
      recovery_action: "validate_duration"
      severity: "warning"
    
    S105:
      code: "S105"
      message: "Invalid resource type"
      http_status: 400
      retryable: false
      recovery_action: "use_valid_resource_type"
      severity: "warning"
    
    S106:
      code: "S106"
      message: "Invalid witness address for voting"
      http_status: 400
      retryable: false
      recovery_action: "validate_witness_address"
      severity: "warning"
    
    S107:
      code: "S107"
      message: "Invalid delegate address for delegation"
      http_status: 400
      retryable: false
      recovery_action: "validate_delegate_address"
      severity: "warning"
    
    S108:
      code: "S108"
      message: "Missing required private key"
      http_status: 400
      retryable: false
      recovery_action: "provide_private_key"
      severity: "high"

  # Staking Processing Errors (S2xx)
  staking_processing:
    S200:
      code: "S200"
      message: "Insufficient wallet balance for staking"
      http_status: 400
      retryable: true
      recovery_action: "fund_wallet"
      severity: "high"
    
    S201:
      code: "S201"
      message: "Insufficient network bandwidth/energy"
      http_status: 503
      retryable: true
      recovery_action: "wait_for_resources"
      severity: "high"
    
    S202:
      code: "S202"
      message: "Staking transaction broadcast failed"
      http_status: 502
      retryable: true
      recovery_action: "retry_broadcast"
      severity: "high"
    
    S203:
      code: "S203"
      message: "Staking transaction confirmation timeout"
      http_status: 504
      retryable: true
      recovery_action: "check_transaction_status"
      severity: "high"
    
    S204:
      code: "S204"
      message: "Staking transaction rejected by network"
      http_status: 400
      retryable: false
      recovery_action: "investigate_rejection"
      severity: "high"
    
    S205:
      code: "S205"
      message: "Wallet locked for security verification"
      http_status: 423
      retryable: true
      recovery_action: "wait_for_unlock"
      severity: "high"
    
    S206:
      code: "S206"
      message: "Staking transaction signature invalid"
      http_status: 400
      retryable: false
      recovery_action: "regenerate_signature"
      severity: "high"
    
    S207:
      code: "S207"
      message: "Freeze balance operation failed"
      http_status: 500
      retryable: true
      recovery_action: "retry_freeze_operation"
      severity: "high"

  # Unstaking Errors (S3xx)
  unstaking:
    S300:
      code: "S300"
      message: "Staking record not found"
      http_status: 404
      retryable: false
      recovery_action: "verify_staking_id"
      severity: "warning"
    
    S301:
      code: "S301"
      message: "Staking is not active"
      http_status: 400
      retryable: false
      recovery_action: "check_staking_status"
      severity: "warning"
    
    S302:
      code: "S302"
      message: "Staking has not expired"
      http_status: 400
      retryable: false
      recovery_action: "wait_for_expiration"
      severity: "warning"
    
    S303:
      code: "S303"
      message: "Unfreeze balance operation failed"
      http_status: 500
      retryable: true
      recovery_action: "retry_unfreeze_operation"
      severity: "high"
    
    S304:
      code: "S304"
      message: "Invalid unstaking state transition"
      http_status: 409
      retryable: false
      recovery_action: "check_staking_state"
      severity: "warning"

  # Voting Errors (S4xx)
  voting:
    S400:
      code: "S400"
      message: "Invalid vote count"
      http_status: 400
      retryable: false
      recovery_action: "validate_vote_count"
      severity: "warning"
    
    S401:
      code: "S401"
      message: "Vote exceeds available resources"
      http_status: 400
      retryable: false
      recovery_action: "check_vote_resources"
      severity: "warning"
    
    S402:
      code: "S402"
      message: "Witness not found"
      http_status: 404
      retryable: false
      recovery_action: "verify_witness_address"
      severity: "warning"
    
    S403:
      code: "S403"
      message: "Vote transaction broadcast failed"
      http_status: 502
      retryable: true
      recovery_action: "retry_vote_broadcast"
      severity: "high"
    
    S404:
      code: "S404"
      message: "Vote transaction rejected by network"
      http_status: 400
      retryable: false
      recovery_action: "investigate_vote_rejection"
      severity: "high"

  # Delegation Errors (S5xx)
  delegation:
    S500:
      code: "S500"
      message: "Invalid delegation amount"
      http_status: 400
      retryable: false
      recovery_action: "validate_delegation_amount"
      severity: "warning"
    
    S501:
      code: "S501"
      message: "Delegation exceeds available resources"
      http_status: 400
      retryable: false
      recovery_action: "check_delegation_resources"
      severity: "warning"
    
    S502:
      code: "S502"
      message: "Delegate address not found"
      http_status: 404
      retryable: false
      recovery_action: "verify_delegate_address"
      severity: "warning"
    
    S503:
      code: "S503"
      message: "Delegation transaction broadcast failed"
      http_status: 502
      retryable: true
      recovery_action: "retry_delegation_broadcast"
      severity: "high"
    
    S504:
      code: "S504"
      message: "Delegation transaction rejected by network"
      http_status: 400
      retryable: false
      recovery_action: "investigate_delegation_rejection"
      severity: "high"
    
    S505:
      code: "S505"
      message: "Undelegation operation failed"
      http_status: 500
      retryable: true
      recovery_action: "retry_undelegation"
      severity: "high"

  # Resource Monitoring Errors (S6xx)
  resource_monitoring:
    S600:
      code: "S600"
      message: "Failed to get resource information"
      http_status: 502
      retryable: true
      recovery_action: "retry_resource_fetch"
      severity: "warning"
    
    S601:
      code: "S601"
      message: "Resource data is stale"
      http_status: 503
      retryable: true
      recovery_action: "refresh_resource_data"
      severity: "warning"
    
    S602:
      code: "S602"
      message: "Energy limit exceeded"
      http_status: 429
      retryable: true
      recovery_action: "wait_for_energy_recovery"
      severity: "high"
    
    S603:
      code: "S603"
      message: "Bandwidth limit exceeded"
      http_status: 429
      retryable: true
      recovery_action: "wait_for_bandwidth_recovery"
      severity: "high"

  # State Management Errors (S7xx)
  state_management:
    S700:
      code: "S700"
      message: "Invalid staking state transition"
      http_status: 409
      retryable: false
      recovery_action: "check_staking_state"
      severity: "warning"
    
    S701:
      code: "S701"
      message: "Staking record corruption detected"
      http_status: 500
      retryable: false
      recovery_action: "manual_review"
      severity: "critical"
    
    S702:
      code: "S702"
      message: "Concurrent staking modification detected"
      http_status: 409
      retryable: true
      recovery_action: "retry_operation"
      severity: "high"
    
    S703:
      code: "S703"
      message: "Staking record not persisted"
      http_status: 500
      retryable: true
      recovery_action: "retry_persistence"
      severity: "high"

  # Database Errors (S8xx)
  database:
    S800:
      code: "S800"
      message: "Failed to save staking record"
      http_status: 500
      retryable: true
      recovery_action: "retry_save"
      severity: "high"
    
    S801:
      code: "S801"
      message: "Failed to update staking status"
      http_status: 500
      retryable: true
      recovery_action: "retry_update"
      severity: "high"
    
    S802:
      code: "S802"
      message: "Staking query failed"
      http_status: 500
      retryable: true
      recovery_action: "retry_query"
      severity: "high"
    
    S803:
      code: "S803"
      message: "Resource query failed"
      http_status: 500
      retryable: true
      recovery_action: "retry_query"
      severity: "high"
    
    S804:
      code: "S804"
      message: "Database connection failed"
      http_status: 503
      retryable: true
      recovery_action: "reconnect_database"
      severity: "high"

  # Network Errors (S9xx)
  network:
    S900:
      code: "S900"
      message: "TRON network connection failed"
      http_status: 502
      retryable: true
      recovery_action: "reconnect_network"
      severity: "high"
    
    S901:
      code: "S901"
      message: "TRON network is unresponsive"
      http_status: 503
      retryable: true
      recovery_action: "wait_for_network"
      severity: "high"
    
    S902:
      code: "S902"
      message: "Network configuration invalid"
      http_status: 500
      retryable: false
      recovery_action: "verify_network_config"
      severity: "critical"

# Success Codes
success:
  S200_OK:
    code: "S200"
    message: "Staking created successfully"
  
  S201_OK:
    code: "S201"
    message: "Staking unstaked successfully"
  
  S202_OK:
    code: "S202"
    message: "Witness vote registered successfully"
  
  S203_OK:
    code: "S203"
    message: "Resource delegation successful"
  
  S204_OK:
    code: "S204"
    message: "Resource undelegation successful"

# Error Severity Levels
severity_levels:
  warning:
    level: 1
    action: "log_and_notify"
    escalation_threshold: 10
  
  high:
    level: 2
    action: "alert_and_retry"
    escalation_threshold: 5
  
  critical:
    level: 3
    action: "immediate_alert_and_block"
    escalation_threshold: 1

# Retry Policies by Error Category
retry_policies:
  network:
    max_retries: 5
    backoff: "exponential"
    backoff_factor: 2.0
    max_backoff_seconds: 300
  
  transaction:
    max_retries: 3
    backoff: "exponential"
    backoff_factor: 2.0
    max_backoff_seconds: 60
  
  database:
    max_retries: 3
    backoff: "linear"
    backoff_increment: 1
    max_backoff_seconds: 10
  
  resource_wait:
    max_retries: 10
    backoff: "exponential"
    backoff_factor: 2.0
    max_backoff_seconds: 3600
  
  state_conflict:
    max_retries: 5
    backoff: "exponential"
    backoff_factor: 1.5
    max_backoff_seconds: 30
