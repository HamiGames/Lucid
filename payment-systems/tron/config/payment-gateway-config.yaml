# LUCID TRON Payment Gateway Configuration
# Payment processing, routing, settlement, and webhook management

service:
  name: lucid-tron-payment-gateway
  version: 1.0.0
  description: TRON payment gateway service for payment processing
  type: payment-gateway

payment_processing:
  # Payment Processing Configuration
  enabled: true
  min_amount: 1
  max_amount: 1000000000
  
  # Payment Methods
  methods:
    - direct_transfer
    - payment_gateway
    - swap
    - route
  
  # Payment Priority Levels
  priorities:
    low:
      fee_percent: 0.10
      processing_time_seconds: 120
      retry_attempts: 3
    normal:
      fee_percent: 0.15
      processing_time_seconds: 60
      retry_attempts: 5
    high:
      fee_percent: 0.20
      processing_time_seconds: 30
      retry_attempts: 5
    urgent:
      fee_percent: 0.30
      processing_time_seconds: 10
      retry_attempts: 7
  
  # Payment Status Tracking
  statuses:
    - pending
    - processing
    - confirmed
    - completed
    - failed
    - cancelled
    - refunded
    - disputed

batch_processing:
  # Batch Payment Configuration
  enabled: true
  max_batch_size: 1000
  batch_timeout_seconds: 300
  concurrent_batches: 10
  
  # Batch Status
  statuses:
    - pending
    - processing
    - partial_failure
    - completed
    - failed

fee_management:
  # Fee Configuration
  enabled: true
  fee_calculation: "percentage"
  
  # Base Fees by Priority
  base_fees:
    low: 0.001      # 0.1%
    normal: 0.0015  # 0.15%
    high: 0.002     # 0.2%
    urgent: 0.003   # 0.3%
  
  # Dynamic Fees
  dynamic_fees_enabled: true
  volume_discounts:
    - threshold: 10000
      discount_percent: 5
    - threshold: 100000
      discount_percent: 10
    - threshold: 1000000
      discount_percent: 15

reconciliation:
  # Payment Reconciliation Configuration
  enabled: true
  auto_reconcile: true
  reconciliation_interval_seconds: 300
  confirmation_threshold: 5  # Number of confirmations required
  
  # Reconciliation Status
  statuses:
    - pending
    - processing
    - completed
    - failed
    - disputed

settlement:
  # Settlement Configuration
  enabled: true
  frequency: daily
  settlement_time_utc: "23:00"
  settlement_timezone: "UTC"
  
  # Settlement Threshold
  min_settlement_amount: 100000
  max_settlement_amount: 10000000
  
  # Retention Policy
  retention_period_days: 30
  auto_archival: true

webhooks:
  # Webhook Configuration
  enabled: true
  max_webhooks: 100
  
  # Webhook Events
  events:
    - payment.created
    - payment.started
    - payment.confirmed
    - payment.completed
    - payment.failed
    - payment.refunded
    - payment.disputed
    - batch.created
    - batch.completed
    - settlement.initiated
    - settlement.completed
  
  # Webhook Delivery
  delivery_timeout_seconds: 30
  max_retries: 5
  retry_interval_seconds: 60
  exponential_backoff: true

transaction_limits:
  # Transaction Limits
  single_transaction_max: 1000000000
  daily_transaction_limit: 100000000000
  monthly_transaction_limit: 1000000000000
  
  # Rate Limiting
  payments_per_minute: 1000
  concurrent_payments: 100
  concurrent_batches: 10

refunds:
  # Refund Configuration
  enabled: true
  auto_refund: true
  max_refund_amount: 1000000000
  refund_timeout_hours: 72
  
  # Refund Reasons
  allowed_reasons:
    - user_request
    - payment_failure
    - duplicate_payment
    - merchant_initiated
    - system_error

monitoring:
  # Monitoring Configuration
  metrics_enabled: true
  metrics_interval_seconds: 60
  
  # Metrics to Collect
  metrics:
    - total_payments
    - successful_payments
    - failed_payments
    - total_volume
    - total_fees
    - refunded_volume
    - average_processing_time
    - success_rate
    - batches_processed
    - webhook_deliveries
    - settlement_amount
  
  # Alerts
  alerts:
    - name: high_failure_rate
      threshold: 10
      action: notify
    - name: high_volume_payment
      threshold: 10000000
      action: alert
    - name: settlement_delay
      threshold: 3600
      action: notify

health_check:
  # Health Check Configuration
  enabled: true
  interval_seconds: 30
  timeout_seconds: 10
  
  # Health Checks
  checks:
    - gateway_availability
    - database_connectivity
    - webhook_queue_status
    - settlement_service_status

api:
  # API Configuration
  base_url: /api/v1/payments
  
  # API Endpoints
  endpoints:
    - path: /create
      method: POST
      description: Create payment
    
    - path: /batch
      method: POST
      description: Process batch payments
    
    - path: /status/{payment_id}
      method: GET
      description: Get payment status
    
    - path: /reconcile
      method: POST
      description: Reconcile payment
    
    - path: /refund
      method: POST
      description: Refund payment
    
    - path: /webhooks/register
      method: POST
      description: Register webhook
    
    - path: /webhooks
      method: GET
      description: List webhooks
    
    - path: /reports/generate
      method: POST
      description: Generate report
    
    - path: /analytics
      method: GET
      description: Get analytics
    
    - path: /fees/calculate
      method: GET
      description: Calculate fees
    
    - path: /settlement/info
      method: GET
      description: Get settlement info

security:
  # Security Configuration
  rate_limiting_enabled: true
  api_key_required: false
  ip_whitelist_enabled: false
  
  # Transaction Validation
  validate_amounts: true
  validate_addresses: true
  prevent_zero_transfers: true
  prevent_self_transfers: true
  
  # Fraud Detection
  fraud_detection_enabled: true
  suspicious_amount_threshold: 1000000
  high_frequency_threshold: 100  # payments per minute per address

database:
  # Database Configuration
  enabled: false
  type: mongodb
  
  collections:
    - name: payments
      ttl_hours: 90
    - name: batches
      ttl_hours: 90
    - name: refunds
      ttl_hours: 90
    - name: settlements
      ttl_hours: 730  # 30 days
    - name: webhooks
      ttl_hours: 8760  # 1 year

logging:
  # Logging Configuration
  level: INFO
  format: json
  
  # Log Events
  log_payments: true
  log_batches: true
  log_reconciliations: true
  log_refunds: true
  log_webhooks: true
  log_errors: true
  
  # Audit Logging
  audit_enabled: true
  audit_log_path: /app/logs/payment-gateway-audit.log

caching:
  # Cache Configuration
  enabled: true
  backend: memory
  ttl_seconds: 300
  
  # Cached Items
  cache:
    - payment_status
    - fee_rates
    - settlement_info
    - analytics_data

deployment:
  # Deployment Configuration
  environment: production
  platform: arm64
  service_port: 8097
  service_host: 0.0.0.0
  workers: 4
  
  # Service Discovery
  service_discovery_enabled: true
  register_as: payment-gateway
  service_tags:
    - payment
    - processing
    - settlement
    - tron
