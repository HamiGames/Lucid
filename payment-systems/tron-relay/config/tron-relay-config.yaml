# Lucid TRON Relay - Service Configuration
# YAML configuration for TRON relay service
# File: payment-systems/tron-relay/config/tron-relay-config.yaml
# SECURITY: READ-ONLY service - NO private key access

# Global Configuration
global:
  service_name: "lucid-tron-relay"
  service_version: "1.0.0"
  debug: false
  log_level: "INFO"
  host: "0.0.0.0"
  port: 8098

# Relay Configuration
relay:
  # Unique relay identifier
  relay_id: "${RELAY_ID:-relay-001}"
  
  # Associated node ID (if running on a Lucid node)
  node_id: "${NODE_ID:-}"
  
  # Relay mode: validator, cache, monitor, full
  mode: "${RELAY_MODE:-full}"
  
  # Capabilities
  capabilities:
    cache: true
    verification: true
    monitoring: true
  
  # Security
  security:
    read_only: true
    no_private_keys: true
    no_signing: true
    no_broadcasting: true

# TRON Network Configuration (READ-ONLY)
tron:
  network_type: "${TRON_NETWORK:-mainnet}"
  
  # RPC endpoints
  endpoints:
    mainnet: "${TRON_RPC_URL_MAINNET:-https://api.trongrid.io}"
    shasta: "${TRON_RPC_URL_SHASTA:-https://api.shasta.trongrid.io}"
    nile: "${TRON_RPC_URL_NILE:-https://nile.trongrid.io}"
  
  # API configuration
  api:
    key: "${TRONGRID_API_KEY:-${TRON_API_KEY:-}}"
    timeout_seconds: 30
    max_retries: 3
    retry_delay_seconds: 1

# Master Service Connection
master:
  url: "${TRON_MASTER_URL:-${TRON_CLIENT_URL:-http://lucid-tron-client:8091}}"
  registration_enabled: true
  heartbeat_interval_seconds: 60
  retry_on_failure: true
  max_retries: 5

# Cache Configuration
cache:
  enabled: true
  
  # Global settings
  max_size_mb: 500
  default_ttl_seconds: 60
  
  # Per-type TTL settings
  ttl:
    block: 300  # 5 minutes
    transaction: 3600  # 1 hour (immutable once confirmed)
    transaction_info: 3600
    account: 30  # 30 seconds (balances change)
    balance: 30
    resources: 60
    chain_parameters: 600  # 10 minutes
  
  # Cache limits
  limits:
    max_entries_per_type: 10000
    eviction_policy: "lru"  # Least Recently Used
    cleanup_interval_seconds: 300

# Verification Configuration
verification:
  enabled: true
  
  # Confirmation requirements
  confirmation_threshold: 20
  timeout_seconds: 30
  
  # Batch processing
  max_batch_size: 100
  batch_timeout_seconds: 60
  
  # TRC20 verification
  trc20:
    enabled: true
    validate_contract: true
    validate_amount: true

# Rate Limiting
rate_limiting:
  enabled: true
  requests_per_minute: 100
  burst_size: 150
  window_seconds: 60

# Monitoring
monitoring:
  enabled: true
  
  metrics:
    enabled: true
    endpoint: "/metrics"
    port: 9098
  
  health_check:
    enabled: true
    endpoint: "/health"
    interval_seconds: 30
    timeout_seconds: 10

# Logging
logging:
  level: "${LOG_LEVEL:-INFO}"
  format: "json"
  file: "${LOG_FILE:-/app/logs/tron-relay.log}"
  
  # Log rotation
  rotation:
    max_size_mb: 100
    max_files: 5
    compress: true

# Error Handling
error_handling:
  retry:
    enabled: true
    max_retries: 3
    delay_seconds: 1
    exponential_backoff: true
  
  fallback:
    use_cache_on_error: true
    return_stale_data: true
    max_stale_age_seconds: 300

# Data Directories
data:
  base_directory: "${DATA_DIRECTORY:-/data/tron-relay}"
  cache_directory: "${CACHE_DIRECTORY:-/data/cache}"
  logs_directory: "${LOG_FILE:-/app/logs}"

