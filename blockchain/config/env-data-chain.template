# =============================================================================
# Lucid Data Chain Service - Environment Variables Template
# =============================================================================
# File: blockchain/config/env-data-chain.template
# Purpose: Template for all configurable environment variables for data-chain container
# Usage: Copy to configs/environment/.env.data-chain and customize values
# =============================================================================

# =============================================================================
# DATA CHAIN SERVICE SETTINGS
# =============================================================================
SERVICE_NAME=data-chain
SERVICE_VERSION=1.0.0
DATA_CHAIN_HOST=127.0.0.1
DATA_CHAIN_PORT=8087
DATA_CHAIN_URL=http://data-chain:8087
LUCID_NAMESPACE=lucid
LUCID_CLUSTER=core
LUCID_PLATFORM=arm64
LUCID_ENV=production

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# MongoDB Connection - REQUIRED
# Alternative: MONGO_URL, MONGODB_URI
# Note: If MONGODB_PASSWORD is not substituted by shell, Python code will handle {MONGODB_PASSWORD} placeholder
MONGODB_URL=mongodb://lucid:${MONGODB_PASSWORD}@lucid-mongodb:27017/lucid?authSource=admin
MONGO_URL=${MONGODB_URL}
MONGODB_URI=${MONGODB_URL}
MONGO_DB=lucid
DATABASE_NAME=lucid
DATA_CHAIN_DB_NAME=lucid

# MongoDB Connection Settings
MONGODB_SERVER_SELECTION_TIMEOUT_MS=5000
MONGODB_CONNECT_TIMEOUT_MS=10000
MONGODB_SOCKET_TIMEOUT_MS=20000
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=5
MONGODB_MAX_IDLE_TIME_MS=30000
MONGODB_RETRY_WRITES=true
MONGODB_RETRY_READS=true

# MongoDB Collection Configuration
MONGODB_DATABASE_NAME=lucid

# =============================================================================
# REDIS CONFIGURATION - REQUIRED
# =============================================================================
REDIS_URL=redis://lucid-redis:6379/0
REDIS_HOST=lucid-redis
REDIS_PORT=6379
REDIS_DB=0

# =============================================================================
# DEPENDENCY SERVICE CONFIGURATION
# =============================================================================
# Blockchain Engine Service (optional - data-chain can operate standalone)
BLOCKCHAIN_ENGINE_URL=http://blockchain-engine:8084
BLOCKCHAIN_ENGINE_HOST=blockchain-engine
BLOCKCHAIN_ENGINE_PORT=8084

# =============================================================================
# CHUNK MANAGEMENT CONFIGURATION
# =============================================================================
# Chunk Size Configuration (in bytes)
DATA_CHAIN_CHUNK_SIZE_BYTES=1048576
CHUNK_SIZE_BYTES=${DATA_CHAIN_CHUNK_SIZE_BYTES}
DATA_CHAIN_MAX_CHUNK_SIZE_BYTES=10485760
MAX_CHUNK_SIZE_BYTES=${DATA_CHAIN_MAX_CHUNK_SIZE_BYTES}
DATA_CHAIN_MIN_CHUNK_SIZE_BYTES=1024
MIN_CHUNK_SIZE_BYTES=${DATA_CHAIN_MIN_CHUNK_SIZE_BYTES}
DATA_CHAIN_SPLIT_THRESHOLD_BYTES=1048576
SPLIT_THRESHOLD_BYTES=${DATA_CHAIN_SPLIT_THRESHOLD_BYTES}
DATA_CHAIN_CHUNK_OVERLAP_BYTES=0
CHUNK_OVERLAP_BYTES=${DATA_CHAIN_CHUNK_OVERLAP_BYTES}

# Chunk Creation Settings
DATA_CHAIN_AUTO_SPLIT=true
DATA_CHAIN_PRESERVE_BOUNDARIES=true

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
# Storage Backend (mongodb, filesystem, s3)
DATA_CHAIN_CHUNK_STORAGE_BACKEND=mongodb
DATA_CHAIN_STORAGE_BACKEND=${DATA_CHAIN_CHUNK_STORAGE_BACKEND}
CHUNK_STORAGE_BACKEND=${DATA_CHAIN_CHUNK_STORAGE_BACKEND}

# Storage Paths
DATA_CHAIN_CHUNK_STORAGE_PATH=/data/chunks
CHUNK_STORAGE_PATH=${DATA_CHAIN_CHUNK_STORAGE_PATH}

# Storage Options
DATA_CHAIN_STORE_METADATA=true
DATA_CHAIN_STORE_CONTENT=true
DATA_CHAIN_STORE_HASHES=true
DATA_CHAIN_COMPRESSION_ENABLED=true

# Compression Algorithm (zstd, lz4, gzip, none)
DATA_CHAIN_CHUNK_COMPRESSION_ALGORITHM=zstd
DATA_CHAIN_COMPRESSION_ALGORITHM=${DATA_CHAIN_CHUNK_COMPRESSION_ALGORITHM}

# =============================================================================
# INTEGRITY VERIFICATION CONFIGURATION
# =============================================================================
# Hash Verification
DATA_CHAIN_HASH_VERIFICATION_ENABLED=true
DATA_CHAIN_VERIFY_CHUNK_HASHES=true
DATA_CHAIN_VERIFY_MERKLE_ROOT=true
DATA_CHAIN_VERIFY_PROOF_PATHS=true

# Verification Timing
DATA_CHAIN_VERIFICATION_ON_RETRIEVAL=true
DATA_CHAIN_VERIFICATION_ON_STORAGE=true

# Hash Algorithm (BLAKE3, SHA256, SHA512)
DATA_CHAIN_HASH_ALGORITHM=BLAKE3
ANCHORING_HASH_ALGORITHM=${DATA_CHAIN_HASH_ALGORITHM}

# Periodic Verification
DATA_CHAIN_PERIODIC_VERIFICATION_ENABLED=true
DATA_CHAIN_VERIFICATION_INTERVAL_HOURS=24
VERIFICATION_INTERVAL_HOURS=${DATA_CHAIN_VERIFICATION_INTERVAL_HOURS}
DATA_CHAIN_VERIFY_SAMPLE_PERCENTAGE=10
VERIFY_SAMPLE_PERCENTAGE=${DATA_CHAIN_VERIFY_SAMPLE_PERCENTAGE}

# Checksum Verification
DATA_CHAIN_CHECKSUM_VERIFICATION=true
DATA_CHAIN_SIZE_VERIFICATION=true
DATA_CHAIN_CORRUPTION_DETECTION=true

# =============================================================================
# DEDUPLICATION CONFIGURATION
# =============================================================================
# Deduplication Settings
DATA_CHAIN_DEDUPLICATION_ENABLED=true
DATA_CHAIN_DEDUPLICATION_METHOD=content_hash
DEDUPLICATION_METHOD=${DATA_CHAIN_DEDUPLICATION_METHOD}

# Deduplication Hash Algorithm
DATA_CHAIN_DEDUPLICATION_HASH_ALGORITHM=BLAKE3
ANCHORING_HASH_ALGORITHM=${DATA_CHAIN_DEDUPLICATION_HASH_ALGORITHM}

# Garbage Collection
DATA_CHAIN_GC_ENABLED=true
DATA_CHAIN_GC_INTERVAL_HOURS=24
GC_INTERVAL_HOURS=${DATA_CHAIN_GC_INTERVAL_HOURS}

# Reference Counting
DATA_CHAIN_REFERENCE_COUNTING=true
DATA_CHAIN_STORE_REFERENCES=true

# =============================================================================
# API CONFIGURATION
# =============================================================================
API_TITLE=Lucid Data Chain API
DATA_CHAIN_API_TITLE=${API_TITLE}
API_VERSION=1.0.0
DATA_CHAIN_API_VERSION=${API_VERSION}
API_DESCRIPTION=API for data chain operations including chunk management, Merkle trees, and integrity verification
API_BASE_PATH=/api/v1
API_DEBUG=false

# CORS Settings
DATA_CHAIN_CORS_ORIGINS=*
CORS_ORIGINS=${DATA_CHAIN_CORS_ORIGINS}
CORS_CREDENTIALS=true
CORS_METHODS=*
CORS_HEADERS=*

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=standard
LOG_OUTPUT=stdout
LOG_FILE_PATH=/app/logs/data-chain.log
LOG_MAX_SIZE_MB=10
LOG_MAX_BACKUPS=5
DEBUG=false

# Log Rotation
LOG_ROTATE_ENABLED=true
LOG_ROTATE_MAX_BYTES=10485760
LOG_ROTATE_BACKUP_COUNT=5

# =============================================================================
# MONITORING & METRICS CONFIGURATION
# =============================================================================
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics
EXPOSE_HEALTH=true
EXPOSE_METRICS=false

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================
HEALTH_CHECK_PATH=/health
DATA_CHAIN_HEALTH_PATH=${HEALTH_CHECK_PATH}
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
DATA_CHAIN_HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=90s

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
STORAGE_DATA_PATH=/app/data
STORAGE_LOGS_PATH=/app/logs
STORAGE_OWNER=65532:65532
STORAGE_ENSURE_PERMISSIONS=true

# MongoDB Storage Collections
STORAGE_COLLECTION_NAME=data_chunks
STORAGE_DATABASE_NAME=lucid

# =============================================================================
# RETRY POLICIES
# =============================================================================
RETRY_ENABLED=true
RETRY_MAX_ATTEMPTS=3
RETRY_DELAY_SECONDS=5
RETRY_EXPONENTIAL_BACKOFF=true
RETRY_BACKOFF_MULTIPLIER=2
RETRY_MAX_BACKOFF_SECONDS=60

# =============================================================================
# TIMEOUT POLICIES
# =============================================================================
TIMEOUT_DEFAULT_CONNECT=5s
TIMEOUT_DEFAULT_REQUEST=30s
TIMEOUT_DEFAULT_IDLE=300s

# Database Timeouts
TIMEOUT_DATABASE_CONNECT=10s
TIMEOUT_DATABASE_REQUEST=60s
TIMEOUT_DATABASE_IDLE=600s

# =============================================================================
# CIRCUIT BREAKER CONFIGURATION
# =============================================================================
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=3

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Container Security
CONTAINER_USER=65532
CONTAINER_GROUP=65532
READ_ONLY_ROOT=true

# Authentication & Authorization
REQUIRE_AUTHENTICATION=true
REQUIRE_AUTHORIZATION=true
ALLOWED_ROLES=USER,NODE_OPERATOR,ADMIN,SUPER_ADMIN

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================
# Network Settings
LUCID_PI_NETWORK=lucid-pi-network
LUCID_PI_SUBNET=172.20.0.0/16
LUCID_PI_GATEWAY=172.20.0.1
NETWORK_DRIVER=bridge

# Service IPs (lucid-pi-network)
DATA_CHAIN_IP=172.20.0.18
BLOCKCHAIN_ENGINE_IP=172.20.0.15
MONGODB_IP=172.20.0.11
REDIS_IP=172.20.0.12

# Service Hosts (container names)
DATA_CHAIN_HOST_CONTAINER=data-chain
BLOCKCHAIN_ENGINE_HOST_CONTAINER=blockchain-engine
MONGODB_HOST_CONTAINER=lucid-mongodb
REDIS_HOST_CONTAINER=lucid-redis

# Service Ports
DATA_CHAIN_PORT=8087
BLOCKCHAIN_ENGINE_PORT=8084
MONGODB_PORT=27017
REDIS_PORT=6379

# =============================================================================
# SERVICE HEALTH PATHS
# =============================================================================
DATA_CHAIN_HEALTH_PATH=/health
BLOCKCHAIN_ENGINE_HEALTH_PATH=/health

# =============================================================================
# SERVICE HEALTH CHECK INTERVALS
# =============================================================================
DATA_CHAIN_HEALTH_CHECK_INTERVAL=30s
DATA_CHAIN_HEALTH_CHECK_TIMEOUT=10s
BLOCKCHAIN_ENGINE_HEALTH_CHECK_INTERVAL=30s
BLOCKCHAIN_ENGINE_HEALTH_CHECK_TIMEOUT=10s

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================
CACHE_ENABLED=true
CACHE_TTL_SECONDS=3600
CACHE_MAX_SIZE_MB=500

# =============================================================================
# ERROR HANDLING CONFIGURATION
# =============================================================================
ERROR_LOG_ALL=true
ERROR_LOG_STACK_TRACES=true
ERROR_SUMMARY_INTERVAL_SECONDS=300
ERROR_MAX_PER_SUMMARY=100

# Failure Handling
FAILURE_LOG_ENABLED=true
FAILURE_NOTIFY_ON_ERROR=false
FAILURE_FALLBACK_STORAGE=off_chain

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# Async Processing
ASYNC_PROCESSING_ENABLED=true
ASYNC_MAX_CONCURRENT_OPERATIONS=10
ASYNC_QUEUE_SIZE=1000
ASYNC_WORKER_THREADS=4

# =============================================================================
# GRACEFUL DEGRADATION
# =============================================================================
DEGRADATION_ENABLED=true
DEGRADATION_READ_ONLY_MODE_ON_ERROR=false
DEGRADATION_DISABLE_OPERATIONS_ON_STORAGE_ERROR=false
DEGRADATION_CACHE_ONLY_MODE_ON_STORAGE_ERROR=false

# =============================================================================
# DEPLOYMENT INFORMATION
# =============================================================================
# Build Information (set by Docker build args)
BUILD_DATE=
VCS_REF=
VERSION=1.0.0

