# Lucid API - SBOM Configuration
# Configuration for Software Bill of Materials generation

# SBOM Generation Settings
sbom:
  # Output formats to generate
  formats:
    - "spdx-json"
    - "cyclonedx-json" 
    - "syft-json"
  
  # Output directory structure
  output:
    base_dir: "build/sbom"
    phase_dir: "build/sbom/phase{phase}"
    archive_dir: "build/sbom/archive"
  
  # Retention policy
  retention:
    keep_versions: 10
    archive_after_days: 30
    cleanup_after_days: 90

# Container Scanning Configuration
containers:
  # Phase 1 containers
  phase1:
    - name: "lucid-mongodb"
      image: "pickme/lucid-mongodb:latest-arm64"
      critical: true
    - name: "lucid-redis"
      image: "pickme/lucid-redis:latest-arm64"
      critical: true
    - name: "lucid-elasticsearch"
      image: "pickme/lucid-elasticsearch:latest-arm64"
      critical: true
    - name: "lucid-auth-service"
      image: "pickme/lucid-auth-service:latest-arm64"
      critical: true

# Vulnerability Scanning Configuration
vulnerability_scanning:
  # Severity levels to scan
  severities:
    - "CRITICAL"
    - "HIGH"
    - "MEDIUM"
    - "LOW"
  
  # Output formats
  formats:
    - "json"
    - "table"
    - "sarif"
  
  # Compliance thresholds
  thresholds:
    critical_max: 0
    high_max: 10
    medium_max: 50
    low_max: 100

# Security Compliance Configuration
compliance:
  # Scoring weights
  scoring:
    sbom_generation: 25
    vulnerability_scanning: 30
    container_security: 25
    security_config: 20
  
  # Pass/fail thresholds
  thresholds:
    excellent: 90
    good: 80
    acceptable: 70
    needs_improvement: 60
    failed: 0

# Tool Configuration
tools:
  syft:
    version: "latest"
    timeout: 300
    memory_limit: "1Gi"
  
  trivy:
    version: "latest"
    timeout: 600
    memory_limit: "2Gi"
    database_update: true
  
  jq:
    version: "latest"

# Reporting Configuration
reporting:
  # Generate reports in these formats
  formats:
    - "json"
    - "html"
    - "pdf"
  
  # Report content
  include:
    - "vulnerability_summary"
    - "compliance_score"
    - "recommendations"
    - "trend_analysis"
  
  # Output locations
  output:
    reports_dir: "build/security-scans/reports"
    summary_file: "security_compliance_summary.json"
    detailed_report: "security_compliance_detailed.json"

# Notification Configuration
notifications:
  # Alert on critical issues
  alerts:
    critical_vulnerabilities: true
    compliance_failure: true
    scan_failure: true
  
  # Notification methods
  methods:
    - "console"
    - "file"
    # - "email"  # Future implementation
    # - "slack"  # Future implementation

# Security Policies
policies:
  # Container security policies
  containers:
    require_distroless: true
    require_multi_stage: true
    require_no_root: true
    require_readonly: true
  
  # Vulnerability policies
  vulnerabilities:
    block_critical: true
    block_high_on_critical: true
    require_justification: true
  
  # SBOM policies
  sbom:
    require_all_formats: true
    require_verification: true
    require_retention: true

# Integration Settings
integration:
  # CI/CD integration
  ci_cd:
    fail_on_critical: true
    fail_on_compliance_below: 80
    generate_reports: true
  
  # Container registry integration
  registry:
    scan_on_push: true
    sign_images: false  # Future implementation
    verify_signatures: false  # Future implementation